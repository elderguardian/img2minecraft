<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>YUI</title>
    <script src="blockdata/blocks.js"></script>
    <script src="js/closestBlock.js"></script>
    <script src="js/mapArt.js"></script>
    <link rel="stylesheet" href="style/app.css">
    <style>

        * {
            padding: 0;
            margin: 0;
            box-sizing: border-box;
        }

        table {
            border-spacing: 0;
            border-collapse: collapse;
        }

        th, td, img {
            padding: 0;
            width: 7px;
            height: 7px;
        }

        img {
            display: block;
        }

    </style>
</head>
<body>

<div>
    <h1>Image 2 minecraft</h1>
    <p>Click on converted image to download</p>
    <label for="imageUploadInput">File</label>
    <input id="imageUploadInput" onchange="onImageChange()" name="file" type="file" accept="image/*">
</div>

<div id="outputContainer">

</div>

<script>

    const imageUploadInput = document.getElementById('imageUploadInput')
    const outputContainerElement = document.querySelector('#outputContainer')

    const downloadCanvas = (canvas, name) => {
        const downloadLink = document.createElement('a')
        downloadLink.href = canvas.toDataURL('image/png')
        downloadLink.download = name
        downloadLink.click()
    }

    const onImageChange = async () => {
        const imageFile = imageUploadInput.files[0]

        outputContainerElement.innerHTML = ''

        const resultCanvas = await imageToMinecraft(imageFile)
        const randomFileName = (Math.random() + 1).toString(36).substring(7)
        resultCanvas.onclick = () => downloadCanvas(resultCanvas, randomFileName)

        outputContainerElement.appendChild(resultCanvas)
    }

</script>
</body>
</html>